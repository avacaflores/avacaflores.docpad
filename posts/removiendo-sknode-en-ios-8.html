<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Removiendo SKNode en iOS 8 | Por puro gusto</title>
    <meta name="description" content="" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="/favicon.ico">
    <link  rel="stylesheet" href="/css/screen.css" /><link  rel="stylesheet" href="/css/railscasts.css" /><link  rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <meta name="generator" content="Docpad 6.x" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Rock+Salt" />
  </head>
  <body class="post-template nav-closed">
    <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
      <span class="hidden">Close</span>
    </a>
    <ul>
      
        <li class="nav-any" role="presentation">
          <a href="/">Blog</a>
        </li>
      
        <li class="nav-any" role="presentation">
          <a href="/about.html">Acerca de...</a>
        </li>
      
        <li class="nav-any" role="presentation">
          <a href="/recursos.html">Recursos</a>
        </li>
      
        <li class="nav-any" role="presentation">
          <a href="/proyectos.html">Proyectos</a>
        </li>
      
    </ul>
</div>
<span class="nav-cover"></span>
    <div class="site-wrapper">
    
      <header class="main-header post-head" style="background-image: url(/img/spritekit.png)">
  
    
  <nav class="main-nav overlay clearfix">
    
    
      <a class="menu-button icon-menu" href="#"><span class="word">Menu</span></a>
       
  </nav>
</header>

<main class="content" role="main">
  <article class="post">

    <header class="post-header">
      <h1 class="post-title">Removiendo SKNode en iOS 8</h1>
      <section class="post-meta">
        
        <time class="post-date" datetime="2014-julio-30">30 julio 2014</time> | 
  <a href="/tags/objective-c.html">objective-c</a>, 

  <a href="/tags/spritekit.html">spritekit</a>, 

  <a href="/tags/ios.html">ios</a>, 

  <a href="/tags/games.html">games</a>, 

  <a href="/tags/movil.html">movil</a>

      </section>
    </header>
    
    <section class="post-content">
      <p>La nueva versión de Xcode 6 trae muchos cambios entre ellos algunos que mas bien parecerían ser errores, tal es el caso de la función <code>removeFromParent</code> en SpriteKit. </p>
<h2 id="el-problema">El problema</h2>
<p>Normalmente en un juego desarrollado en SpriteKit se utiliza el siguiente código para eliminar todos los <strong>SKNode</strong> que estan fuera del <strong>SKScene</strong> o que cumplen determinada condición. El siguiente código es usado por ejemplo en la función <code>didSimulatePhysics</code></p>
<pre class="highlight"><code class="hljs scheme"><span class="hljs-list">[<span class="hljs-keyword">self</span> enumerateChildNodesWithName:@<span class="hljs-string">"mySprite"</span> usingBlock:^<span class="hljs-list">(<span class="hljs-keyword">SKNode</span> *node, BOOL *stop)</span> {

  <span class="hljs-list">[<span class="hljs-keyword">node</span> removeFromParent]<span class="hljs-comment">;</span>

}]<span class="hljs-comment">;</span>
</span></span></code></pre><p>Sin embargo, este código que fue usado en varias versiones de iOS no es válido en iOS 8 ya que causa un error cuando es ejecutado. Aparentemente el usar <code>removeFromParenet</code> dentro de un bloque no es un procedimiento valido a partir de la versión de Xcode 6.</p>
<h2 id="la-soluci-n">La solución</h2>
<p>Para lograr remover los <strong>SKNode</strong> de un <strong>SKScene</strong> sin utilizar este código tendremos de dilatar el comando hasta que todos los nodos sean enumerados, la propuesta es usar el siguiente código:</p>
<pre class="highlight"><code class="hljs objectivec"><span class="hljs-built_in">NSMutableArray</span>* nodesToRemove = [<span class="hljs-built_in">NSMutableArray</span> array];

[<span class="hljs-keyword">self</span> enumerateChildNodesWithName:<span class="hljs-string">@"mySprite"</span> usingBlock:^(SKNode *node, <span class="hljs-built_in">BOOL</span> *stop) {

  [nodesToRemove addObject:node];

}];

<span class="hljs-keyword">for</span> (SKNode* node <span class="hljs-keyword">in</span> nodesToRemove){

  [node removeFromParent];
}
</code></pre><p>Simplemente guardamos todas las referencias de los nodos a eliminar en un <strong>array</strong> y luego removemos todos los nodos que fueron almacenados.</p>
<p>Esperemos que este <strong>workaround</strong> sea algo temporal y que este comportamiento sea solo un error que será solucionado en versiones futuras de Xcode. La versión en la cual fue utilizado este código es Xcode 6 (Beta 4).</p>

    </section>
    
    <footer class="post-footer">

      
      <figure class="author-image">
        <a class="img" href="" style="background-image: url(/img/logo.png)"><span class="hidden">Alfonso Vacaflores's Picture</span></a>
      </figure>
      

      <section class="author">
        <h4><a href="">Alfonso Vacaflores</a></h4>

        
        <div class="author-meta">
          
          <span class="author-location icon-location">Tarija, Bolivia</span>
          
          
        </div>
      </section>

      <section class="share">
        <h4>Compartir</h4>
        <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=Removiendo%20SKNode%20en%20iOS%208&amp;url="
          onclick="window.open(this.href + window.location.href, 'twitter-share', 'width=550,height=235');return false;">
          <span class="hidden">Twitter</span>
        </a>
        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u="
          onclick="window.open(this.href + window.location.href, 'facebook-share','width=580,height=296');return false;">
          <span class="hidden">Facebook</span>
        </a>
        <a class="icon-google-plus" href="https://plus.google.com/share?url="
          onclick="window.open(this.href + window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <span class="hidden">Google+</span>
        </a>
      </section>

    </footer>

  </article>
</main>

<aside class="read-next">
  
    
  
    
  
    
  
    
  
    
  
    
      
        <a class="read-next-story" style="background-image: url(/img/swift.jpg)" href="/posts/plist-en-swift.html">
          <section class="post">
            <h2>plist en Swift</h2>
            <p>La presentación del nuevo leguaje de programación Swift a despertado a un grupo muy grande programadores y no programadores,&hellip;</p>
          </section>
        </a>
      
      
        <a class="read-next-story prev" style="background-image: url(/img/git.jpg)" href="/posts/git-shortcuts.html">
          <section class="post">
            <h2>Git shortcuts</h2>
            <p>Git es un mundo lleno de comandos que deben ser utilizados en la consola, se me hace muy difícil&hellip;</p>
          </section>
        </a>
      
    
  
    
  
    
  
    
  
    
  
    
  
</aside>

      <footer class="site-footer clearfix">
      	<div class="tagcloud">
	
		<a href="/tags/android.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> android </a>
	
		<a href="/tags/asynctaks.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> asynctaks </a>
	
		<a href="/tags/bi.html" data-tag-count="2" data-tag-weight="0.5" style="font-size: 300%;"> bi </a>
	
		<a href="/tags/blog.html" data-tag-count="3" data-tag-weight="0.7924812503605781" style="font-size: 358.49625007211563%;"> blog </a>
	
		<a href="/tags/docpad.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> docpad </a>
	
		<a href="/tags/games.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> games </a>
	
		<a href="/tags/general.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> general </a>
	
		<a href="/tags/git.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> git </a>
	
		<a href="/tags/ios.html" data-tag-count="2" data-tag-weight="0.5" style="font-size: 300%;"> ios </a>
	
		<a href="/tags/java.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> java </a>
	
		<a href="/tags/json.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> json </a>
	
		<a href="/tags/movil.html" data-tag-count="3" data-tag-weight="0.7924812503605781" style="font-size: 358.49625007211563%;"> movil </a>
	
		<a href="/tags/node-js.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> node.js </a>
	
		<a href="/tags/objective-c.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> objective-c </a>
	
		<a href="/tags/octopress.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> octopress </a>
	
		<a href="/tags/rails.html" data-tag-count="2" data-tag-weight="0.5" style="font-size: 300%;"> rails </a>
	
		<a href="/tags/reportes.html" data-tag-count="2" data-tag-weight="0.5" style="font-size: 300%;"> reportes </a>
	
		<a href="/tags/ruby.html" data-tag-count="2" data-tag-weight="0.5" style="font-size: 300%;"> ruby </a>
	
		<a href="/tags/spritekit.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> spritekit </a>
	
		<a href="/tags/ssrs.html" data-tag-count="2" data-tag-weight="0.5" style="font-size: 300%;"> ssrs </a>
	
		<a href="/tags/swift.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> swift </a>
	
		<a href="/tags/vbasic.html" data-tag-count="2" data-tag-weight="0.5" style="font-size: 300%;"> vbasic </a>
	
		<a href="/tags/web.html" data-tag-count="4" data-tag-weight="1" style="font-size: 400%;"> web </a>
	
		<a href="/tags/yaml.html" data-tag-count="1" data-tag-weight="0" style="font-size: 200%;"> yaml </a>
	
</div>
        <section class="copyright"><a href="index.html">Alfonso Vacaflores</a> &copy; 2016</section>
        <section class="poweredby">Powered by <a href="https://docpad.org">DocPad</a></section>
      </footer>

    </div>
    <script defer="defer"  src="//code.jquery.com/jquery-2.1.4.min.js"></script><script defer="defer"  src="/js/jquery.fitvids.js"></script><script defer="defer"  src="/js/index.js"></script>
  </body>
</html>